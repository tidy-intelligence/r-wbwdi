<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using `wbwdi` with `wbids` • wbwdi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using `wbwdi` with `wbids`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wbwdi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data-model.html">`wbwdi` Data Model</a></li>
    <li><a class="dropdown-item" href="../articles/using-wbwdi-with-wbids.html">Using `wbwdi` with `wbids`</a></li>
    <li><a class="dropdown-item" href="../articles/using-wbwdi.html">Using `wbwdi` to access World Development Indicators</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidy-intelligence/r-wbwdi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using `wbwdi` with `wbids`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidy-intelligence/r-wbwdi/blob/v1.0.3/vignettes/articles/using-wbwdi-with-wbids.Rmd" class="external-link"><code>vignettes/articles/using-wbwdi-with-wbids.Rmd</code></a></small>
      <div class="d-none name"><code>using-wbwdi-with-wbids.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidy-intelligence/r-wbwdi" class="external-link">wbwdi</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://teal-insights.github.io/r-wbids/" class="external-link">wbids</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>wbwdi</code> packages focuses on providing access to World
Bank Development Indicators (WDI), which focus on observations per
entity and year. The <code>wbids</code> package, on the other hand,
provides access to International Debt Statistics (IDS), which are
available by entity, counterpart, and year. However, both packages have
a shared design philosophy in order to work seamlessly together.</p>
<p>In the following examples, we’ll focus on Zambia (ISO-3 country code
“ZMB”). Let us first start by visualizing the total external debt (IDS
series “DT.DOD.DPPG.CD”) and central government debt of of Zambia over
time. Since the IDS data is typically in USD, we calculate the latter by
combining central government debt as a % of GDP (“GC.DOD.TOTL.GD.ZS”)
with GDP in USD (“NY.GDP.MKTP.CD”).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set range to 10 years</span></span>
<span><span class="va">start_year</span> <span class="op">&lt;-</span> <span class="fl">2013</span></span>
<span><span class="va">end_year</span> <span class="op">&lt;-</span> <span class="fl">2022</span></span>
<span></span>
<span><span class="co"># Fetch total government in USD via GDP</span></span>
<span><span class="va">government_debt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wdi_get.html">wdi_get</a></span><span class="op">(</span></span>
<span>  <span class="st">"ZMB"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NY.GDP.MKTP.CD"</span>, <span class="st">"GC.DOD.TOTL.GD.ZS"</span><span class="op">)</span>,</span>
<span>  <span class="va">start_year</span>,</span>
<span>  <span class="va">end_year</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"wide"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">government_debt</span> <span class="op">&lt;-</span> <span class="va">government_debt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    debt <span class="op">=</span> <span class="va">`GC.DOD.TOTL.GD.ZS`</span> <span class="op">/</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">`NY.GDP.MKTP.CD`</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"Government"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entity_id</span>, <span class="va">year</span>, <span class="va">debt</span>, <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch total external debt in USD</span></span>
<span><span class="va">external_debt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://teal-insights.github.io/r-wbids/reference/ids_get.html" class="external-link">ids_get</a></span><span class="op">(</span></span>
<span>  <span class="st">"ZMB"</span>,</span>
<span>  <span class="st">"DT.DOD.DPPG.CD"</span>,</span>
<span>  <span class="st">"all"</span>,</span>
<span>  <span class="va">start_year</span>,</span>
<span>  <span class="va">end_year</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Counterpart "WLD" indicates whole world</span></span>
<span><span class="va">debt_levels</span> <span class="op">&lt;-</span> <span class="va">external_debt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">counterpart_id</span> <span class="op">==</span> <span class="st">"WLD"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">entity_id</span>, <span class="va">year</span>, debt <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"External Debt"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">government_debt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize debt levels</span></span>
<span><span class="va">debt_levels</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">debt</span> <span class="op">/</span> <span class="fl">1e9</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Debt Stock (in billion USD)"</span>,</span>
<span>    color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Total Government and External Debt in Zambia"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="using-wbwdi-with-wbids_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" width="672"></p>
<p>The great thing about IDS is that it allows for breakdown of external
debt by creditor, as the next figure shows.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enrich external debt with counterpart names</span></span>
<span><span class="va">debt_breakdown</span> <span class="op">&lt;-</span> <span class="va">external_debt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">counterpart_id</span> <span class="op">!=</span> <span class="st">"WLD"</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://teal-insights.github.io/r-wbids/reference/ids_list_counterparts.html" class="external-link">ids_list_counterparts</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">counterpart_id</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">debt_breakdown</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span> <span class="op">/</span> <span class="fl">1e9</span>, y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">counterpart_name</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"External debt (in billion USD)"</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Top 5 creditors of Zambia in 2022"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"External debt stocks, public and publicly guaranteed"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="using-wbwdi-with-wbids_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="672"></p>
<p>For more applications and insights into international debt, see <a href="https://teal-insights.github.io/teal-insights-guide-to-wbids/" class="external-link">Teal
Insights’ Guide to Working with the World Bank International Debt
Statistics</a>.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christoph Scheuch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
